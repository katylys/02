BIN         := ./node_modules/.bin
TEST_FILES   = $(shell find lib -iname '*_test.ts')
SOURCE_FILES = $(shell find lib -iname '*.ts' -and -not -iname '*_test.ts')

PHONY: lint
lint:
	$(BIN)/tslint $(TEST_FILES) $(SOURCE_FILES) --type-check -p ./tsconfig.json

PHONY: test
test: bootstrap lint
	$(BIN)/mocha -r ts-node/register $(TEST_FILES)

PHONY: bootstrap
bootstrap:
	yarn

PHONY: publish
publish:
	npm publish --access public

PHONY: build-doc
build-doc:
	rm -rf ./docs
	typedoc --out ./docs --mode modules --module commonjs $(SOURCE_FILES)
	touch ./docs/.nojekyll
